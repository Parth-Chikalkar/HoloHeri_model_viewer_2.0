<!doctype html>
<html lang="en">
  <head>
    <title>Konark Temple Interactive</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <style>
      model-viewer {
        width: 100%;
        height: 95vh;
        background-color: #f5f5f5;
      }

      /* The White Buttons (Hotspots) */
      .Hotspot {
        background: #fff;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        border: 3px solid #007bff;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        transition: transform 0.3s, opacity 0.3s;
      }

      /* CRITICAL FOR MOBILE: Show hotspots in AR mode */
      #konark-viewer[ar-status="session-started"] .Hotspot {
        display: block;
      }

      /* Info Box Styling */
      .HotspotAnnotation {
        display: none;
        background: #ffffff;
        border-radius: 8px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.25);
        padding: 12px;
        position: absolute;
        width: 220px; /* Slightly smaller for mobile screens */
        left: 25px;
        top: -20px;
        color: #333;
        font-family: sans-serif;
        line-height: 1.4;
        z-index: 100;
      }

      .active .HotspotAnnotation {
        display: block;
      }

      h3 { margin: 0 0 5px 0; font-size: 16px; color: #007bff; }
      p { margin: 0; font-size: 13px; }
    </style>
  </head>
  <body>

    <model-viewer id="konark-viewer" 
                  src="finalKonark (1).glb" 
                  ar 
                  ar-modes="webxr quick-look scene-viewer" 
                  camera-controls 
                  shadow-intensity="1"
                  camera-orbit="45deg 75deg 15m" 
                  field-of-view="35deg">
      
      <button class="Hotspot" slot="hotspot-3" 
              data-position="0.1044m -0.7710m -4.3724m" 
              data-normal="-0.9717m 0.1797m 0.1527m"
              data-visibility-attribute="visible">
          <div class="HotspotAnnotation">
              <h3>Main Tower (Vimana)</h3>
              <p>The principal shrine of the Konark Sun Temple, symbolizing Mount Meru.</p>
          </div>
      </button>

      <button class="Hotspot" slot="hotspot-8" 
              data-position="0.6554m -1.9247m -1.3890m" 
              data-normal="-0.0009m 0.9999m -0.0073m"
              data-visibility-attribute="visible">
          <div class="HotspotAnnotation">
              <h3>Jagamohana</h3>
              <p>The grand audience hall where devotees gathered. It features a pyramidal roof.</p>
          </div>
      </button>

      <button slot="ar-button" style="background-color: white; border-radius: 4px; border: none; position: absolute; top: 16px; right: 16px; padding: 10px;">
          ðŸ‘‹ View in AR
      </button>

    </model-viewer> 

    <script>
      const hotspots = document.querySelectorAll(".Hotspot");

      hotspots.forEach((hotspot) => {
        // Use 'pointerdown' for better mobile touch response
        hotspot.addEventListener('pointerdown', (event) => {
          event.stopPropagation();
          hotspots.forEach(h => {
            if (h !== hotspot) h.classList.remove('active');
          });
          hotspot.classList.toggle('active');
        });
      });

      // Close if user taps the model background
      document.querySelector('#konark-viewer').addEventListener('click', (event) => {
        if (event.target.classList.contains('Hotspot')) return;
        hotspots.forEach(h => h.classList.remove('active'));
      });
    </script>

    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script>
  </body>
</html>
